<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Card V2 - Michael Rodriguez Guido</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #e0e0e0;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 40px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: #333;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #0a1628;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .controls {
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 10px 20px;
            background: linear-gradient(135deg, #00bcd4 0%, #00e5ff 100%);
            color: #0a1628;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 188, 212, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Simple editor panel */
        .editor {
            width: 100%;
            max-width: 900px;
            background: #ffffff;
            border: 1px solid #ccd6dd;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
            padding: 16px;
            margin: 10px 0 24px;
        }
        .editor h2 {
            font-size: 16px;
            color: #0a1628;
            margin-bottom: 12px;
        }
        .editor-grid {
            display: grid;
            grid-template-columns: repeat(3, minmax(220px, 1fr));
            gap: 12px;
        }
        .field {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .field label {
            font-size: 12px;
            color: #333;
            font-weight: 600;
        }
        .field input {
            padding: 8px 10px;
            border: 1px solid #d5dee6;
            border-radius: 4px;
            font-size: 13px;
            outline: none;
        }
        .field input:focus {
            border-color: #00bcd4;
            box-shadow: 0 0 0 3px rgba(0, 188, 212, 0.15);
        }
        
        .card-container {
            display: flex;
            gap: 40px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .business-card {
            width: 3.5in;
            height: 2in;
            position: relative;
            overflow: hidden;
            border-radius: 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        /* ========== FRONT SIDE ========== */
        .card-front {
            background: linear-gradient(135deg, #0a1628 0%, #0d2847 50%, #0a1628 100%);
            padding: 20px 25px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .card-front::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M50 25 L75 37.5 L75 62.5 L50 75 L25 62.5 L25 37.5 Z' stroke='%2300bcd4' stroke-width='0.5' fill='none' opacity='0.15'/%3E%3C/svg%3E");
            background-size: 60px 60px;
            opacity: 0.4;
            pointer-events: none;
        }
        
        /* Neural network / brain decoration */
        .neural-decoration {
            position: absolute;
            bottom: 10px;
            left: 15px;
            width: 80px;
            height: 60px;
            opacity: 0.6;
        }
        
        .neural-decoration svg {
            width: 100%;
            height: 100%;
        }
        
        /* Circuit lines */
        .circuit-lines {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 120px;
            height: 80px;
            opacity: 0.4;
        }
        
        .circuit-lines svg {
            width: 100%;
            height: 100%;
        }
        
        .content-front {
            position: relative;
            z-index: 1;
        }
        
        .name {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1.2;
            margin-bottom: 4px;
        }
        
        .title {
            font-size: 9px;
            color: #00e5ff;
            font-weight: 600;
            margin-bottom: 15px;
            letter-spacing: 0.5px;
        }
        
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 8px;
            color: #ffffff;
        }
        
        .contact-item .icon {
            width: 14px;
            height: 14px;
            background: linear-gradient(135deg, #00bcd4 0%, #00e5ff 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 7px;
            color: #0a1628;
            flex-shrink: 0;
        }
        
        .social-icons {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        
        .social-icon {
            width: 18px;
            height: 18px;
            background: linear-gradient(135deg, #00bcd4 0%, #00e5ff 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            color: #0a1628;
            text-decoration: none;
            transition: transform 0.2s;
        }
        
        .social-icon:hover {
            transform: scale(1.1);
        }
        
        /* ========== BACK SIDE ========== */
        .card-back {
            background: linear-gradient(135deg, #0a1628 0%, #0d2847 50%, #0a1628 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .card-back::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 229, 255, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(0, 188, 212, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(0, 229, 255, 0.05) 0%, transparent 60%);
            pointer-events: none;
        }
        
        /* Network nodes decoration */
        .network-nodes {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
        }
        
        .node {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #00e5ff;
            border-radius: 50%;
            box-shadow: 0 0 10px #00e5ff, 0 0 20px #00e5ff;
        }
        
        .node:nth-child(1) { top: 15%; left: 10%; width: 4px; height: 4px; opacity: 0.7; }
        .node:nth-child(2) { top: 25%; left: 25%; width: 5px; height: 5px; opacity: 0.8; }
        .node:nth-child(3) { top: 10%; right: 20%; width: 4px; height: 4px; opacity: 0.6; }
        .node:nth-child(4) { bottom: 20%; left: 15%; width: 5px; height: 5px; opacity: 0.7; }
        .node:nth-child(5) { bottom: 30%; right: 15%; width: 4px; height: 4px; opacity: 0.8; }
        .node:nth-child(6) { top: 40%; left: 8%; width: 3px; height: 3px; opacity: 0.5; }
        .node:nth-child(7) { bottom: 15%; right: 25%; width: 5px; height: 5px; opacity: 0.7; }
        .node:nth-child(8) { top: 20%; right: 10%; width: 4px; height: 4px; opacity: 0.6; }
        
        /* Connection lines */
        .connections {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.3;
        }
        
        .connections svg {
            width: 100%;
            height: 100%;
        }
        
        .qr-container {
            position: relative;
            z-index: 1;
            padding: 8px;
            background: transparent;
            border: 2px solid #00e5ff;
            box-shadow: 
                0 0 20px rgba(0, 229, 255, 0.5),
                inset 0 0 20px rgba(0, 229, 255, 0.1);
        }
        
        .qr-container::before,
        .qr-container::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid #00e5ff;
        }
        
        .qr-container::before {
            top: -8px;
            left: -8px;
            border-right: none;
            border-bottom: none;
        }
        
        .qr-container::after {
            bottom: -8px;
            right: -8px;
            border-left: none;
            border-top: none;
        }
        
        .qr-code {
            width: 80px;
            height: 80px;
            background: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .qr-code img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        /* QR Placeholder */
        .qr-placeholder {
            width: 100%;
            height: 100%;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: #333;
            text-align: center;
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .header,
            .controls,
            .editor {
                display: none;
            }
            
            .card-container {
                gap: 20px;
            }
            
            .business-card {
                box-shadow: none;
                border: 1px solid #ccc;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
        
        /* Labels for editing */
        .print-label {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-top: 10px;
            font-weight: 600;
        }
        
        .card-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        @media (max-width: 768px) {
            .card-container {
                gap: 30px;
            }

            .business-card {
                width: 90vw;
                height: calc(90vw * 0.571);
                max-width: 3.5in;
                max-height: 2in;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Business Card Designer - V2</h1>
        <p>Professional Signature Template with Neural Theme</p>
    </div>

    <div class="controls">
        <button class="btn" onclick="printCard()">üñ®Ô∏è Print / PDF</button>
        <button class="btn" onclick="applyDefaults()">‚Ü∫ Apply Defaults</button>
        <button class="btn" onclick="clearAll()">‚úñ Clear All</button>
        <button class="btn" onclick="location.href='index.html'">‚Üê Back to Hub</button>
    </div>

    <!-- Editor: Populate V2 Signature Information -->
    <div class="editor" aria-label="Business Card Settings">
        <h2>Signature Details</h2>
        <div class="editor-grid">
            <div class="field">
                <label for="nameInput">Full Name</label>
                <input id="nameInput" type="text" placeholder="e.g., Michael Rodriguez Guido">
            </div>
            <div class="field">
                <label for="titleInput">Title / Role</label>
                <input id="titleInput" type="text" placeholder="e.g., Business Development Executive">
            </div>
            <div class="field">
                <label for="emailInput">Email</label>
                <input id="emailInput" type="email" placeholder="e.g., name@company.com">
            </div>
            <div class="field">
                <label for="phoneInput">Phone</label>
                <input id="phoneInput" type="text" placeholder="e.g., +971 54 3423 029">
            </div>
            <div class="field" style="grid-column: span 2;">
                <label for="addressInput">Address</label>
                <input id="addressInput" type="text" placeholder="e.g., 201 Al Maseed Building, Deira - Dubai, UAE">
            </div>
            <div class="field">
                <label for="linkedinInput">LinkedIn URL</label>
                <input id="linkedinInput" type="url" placeholder="https://linkedin.com/in/username">
            </div>
            <div class="field">
                <label for="twitterInput">Twitter URL</label>
                <input id="twitterInput" type="url" placeholder="https://twitter.com/username">
            </div>
            <div class="field">
                <label for="facebookInput">Facebook URL</label>
                <input id="facebookInput" type="url" placeholder="https://facebook.com/username">
            </div>
            <div class="field">
                <label for="instagramInput">Instagram URL</label>
                <input id="instagramInput" type="url" placeholder="https://instagram.com/username">
            </div>
            <div class="field" style="grid-column: span 3;">
                <label for="qrInput">QR Content (URL or text)</label>
                <input id="qrInput" type="text" placeholder="https://your-landing-page.example">
            </div>
        </div>
    </div>
    
    <div class="card-container">
        <!-- FRONT SIDE -->
        <div class="card-wrapper">
            <div class="business-card card-front">
                <!-- Hexagon pattern is in CSS ::before -->
                
                <!-- Neural brain decoration -->
                <div class="neural-decoration">
                    <svg viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                        <!-- Brain outline with nodes -->
                        <ellipse cx="50" cy="40" rx="35" ry="28" fill="none" stroke="#00e5ff" stroke-width="1" opacity="0.4"/>
                        <ellipse cx="50" cy="40" rx="25" ry="20" fill="none" stroke="#00e5ff" stroke-width="0.5" opacity="0.3"/>
                        <!-- Neural nodes -->
                        <circle cx="30" cy="35" r="2" fill="#00e5ff" opacity="0.6"/>
                        <circle cx="45" cy="25" r="1.5" fill="#00e5ff" opacity="0.5"/>
                        <circle cx="60" cy="30" r="2" fill="#00e5ff" opacity="0.7"/>
                        <circle cx="70" cy="45" r="1.5" fill="#00e5ff" opacity="0.5"/>
                        <circle cx="55" cy="50" r="2" fill="#00e5ff" opacity="0.6"/>
                        <circle cx="35" cy="50" r="1.5" fill="#00e5ff" opacity="0.4"/>
                        <!-- Connections -->
                        <line x1="30" y1="35" x2="45" y2="25" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                        <line x1="45" y1="25" x2="60" y2="30" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                        <line x1="60" y1="30" x2="70" y2="45" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                        <line x1="70" y1="45" x2="55" y2="50" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                        <line x1="55" y1="50" x2="35" y2="50" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                        <line x1="35" y1="50" x2="30" y2="35" stroke="#00e5ff" stroke-width="0.5" opacity="0.4"/>
                    </svg>
                </div>
                
                <!-- Circuit lines -->
                <div class="circuit-lines">
                    <svg viewBox="0 0 120 80" xmlns="http://www.w3.org/2000/svg">
                        <line x1="0" y1="60" x2="40" y2="60" stroke="#00e5ff" stroke-width="1" opacity="0.3"/>
                        <line x1="40" y1="60" x2="50" y2="50" stroke="#00e5ff" stroke-width="1" opacity="0.3"/>
                        <line x1="50" y1="50" x2="80" y2="50" stroke="#00e5ff" stroke-width="1" opacity="0.3"/>
                        <circle cx="40" cy="60" r="2" fill="#00e5ff" opacity="0.5"/>
                        <circle cx="80" cy="50" r="2" fill="#00e5ff" opacity="0.5"/>
                    </svg>
                </div>
                
                <div class="content-front">
                    <!-- EDITABLE: Name -->
                    <h1 id="nameText" class="name">MICHAEL<br>RODRIGUEZ GUIDO</h1>
                    
                    <!-- EDITABLE: Job Title -->
                    <p id="titleText" class="title">Business Development Executive</p>
                    
                    <div class="contact-info">
                        <!-- EDITABLE: Email -->
                        <div class="contact-item">
                            <span class="icon"><i class="fas fa-envelope"></i></span>
                            <span id="emailText">m.guido@scholarixglobal.com</span>
                        </div>
                        
                        <!-- EDITABLE: Phone -->
                        <div class="contact-item">
                            <span class="icon"><i class="fas fa-phone"></i></span>
                            <span id="phoneText">+971 54 3423 029</span>
                        </div>
                        
                        <!-- EDITABLE: Address -->
                        <div class="contact-item">
                            <span class="icon"><i class="fas fa-map-marker-alt"></i></span>
                            <span id="addressText">201 Al Maseed Building, Deira - Dubai, UAE</span>
                        </div>
                    </div>
                    
                    <!-- EDITABLE: Social Media Links -->
                    <div class="social-icons">
                        <a id="linkedinLink" href="#" class="social-icon" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                        <a id="twitterLink" href="#" class="social-icon" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a id="facebookLink" href="#" class="social-icon" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a id="instagramLink" href="#" class="social-icon" title="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <p class="print-label">FRONT</p>
        </div>
        
        <!-- BACK SIDE -->
        <div class="card-wrapper">
            <div class="business-card card-back">
                <!-- Network nodes -->
                <div class="network-nodes">
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                    <div class="node"></div>
                </div>
                
                <!-- Connection lines -->
                <div class="connections">
                    <svg viewBox="0 0 336 192" xmlns="http://www.w3.org/2000/svg">
                        <!-- Network connection lines -->
                        <line x1="34" y1="29" x2="84" y2="48" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="84" y1="48" x2="168" y2="96" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="269" y1="19" x2="286" y2="58" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="286" y1="58" x2="168" y2="96" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="50" y1="154" x2="168" y2="96" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="286" y1="134" x2="168" y2="96" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="27" y1="77" x2="84" y2="48" stroke="#00e5ff" stroke-width="0.5"/>
                        <line x1="302" y1="38" x2="269" y2="19" stroke="#00e5ff" stroke-width="0.5"/>
                        <!-- Additional connections -->
                        <line x1="34" y1="29" x2="27" y2="77" stroke="#00e5ff" stroke-width="0.3"/>
                        <line x1="50" y1="154" x2="27" y2="77" stroke="#00e5ff" stroke-width="0.3"/>
                        <line x1="269" y1="163" x2="286" y2="134" stroke="#00e5ff" stroke-width="0.3"/>
                    </svg>
                </div>
                
                <!-- QR Code Container -->
                <div class="qr-container">
                    <div class="qr-code">
                        <!-- QR Code - Source will be generated on Print -->
                        <img id="qrImage" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://scholarixglobal.com" alt="QR Code">
                    </div>
                </div>
            </div>
            <p class="print-label">BACK</p>
        </div>
    </div>

    <script>
        // Business Card V2 - Editor + Live Binding + QR on Print
        (function(){
            const els = {
                nameText: document.getElementById('nameText'),
                titleText: document.getElementById('titleText'),
                emailText: document.getElementById('emailText'),
                phoneText: document.getElementById('phoneText'),
                addressText: document.getElementById('addressText'),
                linkedinLink: document.getElementById('linkedinLink'),
                twitterLink: document.getElementById('twitterLink'),
                facebookLink: document.getElementById('facebookLink'),
                instagramLink: document.getElementById('instagramLink'),
                qrImage: document.getElementById('qrImage'),
            };

            const inputs = {
                name: document.getElementById('nameInput'),
                title: document.getElementById('titleInput'),
                email: document.getElementById('emailInput'),
                phone: document.getElementById('phoneInput'),
                address: document.getElementById('addressInput'),
                linkedin: document.getElementById('linkedinInput'),
                twitter: document.getElementById('twitterInput'),
                facebook: document.getElementById('facebookInput'),
                instagram: document.getElementById('instagramInput'),
                qr: document.getElementById('qrInput'),
            };

            const storageKey = 'sgc-it-card-v2';

            function defaultState(){
                return {
                    name: els.nameText.innerText.replace(/\n/g, ' '),
                    title: els.titleText.innerText,
                    email: els.emailText.innerText,
                    phone: els.phoneText.innerText,
                    address: els.addressText.innerText,
                    linkedin: els.linkedinLink.getAttribute('href') || '',
                    twitter: els.twitterLink.getAttribute('href') || '',
                    facebook: els.facebookLink.getAttribute('href') || '',
                    instagram: els.instagramLink.getAttribute('href') || '',
                    qr: 'https://scholarixglobal.com',
                };
            }

            function loadState(){
                try {
                    const raw = localStorage.getItem(storageKey);
                    if (!raw) return defaultState();
                    const obj = JSON.parse(raw);
                    return Object.assign(defaultState(), obj);
                } catch(e){
                    return defaultState();
                }
            }

            function saveState(state){
                try { localStorage.setItem(storageKey, JSON.stringify(state)); } catch(e) {}
            }

            function applyState(state){
                // Inputs
                inputs.name.value = state.name;
                inputs.title.value = state.title;
                inputs.email.value = state.email;
                inputs.phone.value = state.phone;
                inputs.address.value = state.address;
                inputs.linkedin.value = state.linkedin;
                inputs.twitter.value = state.twitter;
                inputs.facebook.value = state.facebook;
                inputs.instagram.value = state.instagram;
                inputs.qr.value = state.qr;

                // Card text
                els.nameText.innerHTML = formatName(state.name);
                els.titleText.textContent = state.title;
                els.emailText.textContent = state.email;
                els.phoneText.textContent = state.phone;
                els.addressText.textContent = state.address;

                // Social URLs
                setHref(els.linkedinLink, state.linkedin);
                setHref(els.twitterLink, state.twitter);
                setHref(els.facebookLink, state.facebook);
                setHref(els.instagramLink, state.instagram);
            }

            function formatName(name){
                // If user includes a line break marker, respect it
                if (name.includes('\n')) {
                    const parts = name.split(/\n+/);
                    return parts.map(p => escapeHtml(p)).join('<br>');
                }
                // Otherwise split first space into two lines
                const idx = name.indexOf(' ');
                if (idx > 0) {
                    const first = escapeHtml(name.slice(0, idx));
                    const rest = escapeHtml(name.slice(idx + 1));
                    return first + '<br>' + rest;
                }
                return escapeHtml(name);
            }

            function escapeHtml(str){
                return String(str).replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
            }

            function setHref(el, url){
                if (!url || url === '#') { el.setAttribute('href', '#'); return; }
                el.setAttribute('href', url);
            }

            function stateFromInputs(){
                return {
                    name: inputs.name.value.trim(),
                    title: inputs.title.value.trim(),
                    email: inputs.email.value.trim(),
                    phone: inputs.phone.value.trim(),
                    address: inputs.address.value.trim(),
                    linkedin: inputs.linkedin.value.trim(),
                    twitter: inputs.twitter.value.trim(),
                    facebook: inputs.facebook.value.trim(),
                    instagram: inputs.instagram.value.trim(),
                    qr: inputs.qr.value.trim(),
                };
            }

            function bindChanges(){
                Object.values(inputs).forEach(inp => {
                    const handler = () => { const s = stateFromInputs(); applyState(s); saveState(s); };
                    inp.addEventListener('input', handler);
                    inp.addEventListener('change', handler);
                });
            }

            function buildQrSrc(content){
                const base = 'https://api.qrserver.com/v1/create-qr-code/';
                const params = new URLSearchParams({ size: '150x150', data: content || '' });
                return `${base}?${params.toString()}`;
            }

            function updateQrImage(content){
                const src = buildQrSrc(content);
                els.qrImage.setAttribute('src', src);
            }

            function deriveQrFallback(s){
                // If user didn't set QR, derive from best available contact
                if (s.qr) return s.qr;
                if (s.linkedin) return s.linkedin;
                if (s.email) return `mailto:${s.email}`;
                if (s.phone) return `tel:${s.phone.replace(/\s+/g,'')}`;
                return 'https://sgctech.ai';
            }

            // Expose printCard globally
            window.printCard = function(){
                const current = stateFromInputs();
                current.qr = deriveQrFallback(current);
                // Update QR image source before printing
                updateQrImage(current.qr || '');
                // Wait a tick to allow image load, then print
                setTimeout(() => { window.print(); }, 250);
            };

            // Utility: apply defaults
            window.applyDefaults = function(){
                const s = defaultState();
                applyState(s);
                saveState(s);
            };

            // Utility: clear all inputs
            window.clearAll = function(){
                const empty = {
                    name: '', title: '', email: '', phone: '', address: '',
                    linkedin: '', twitter: '', facebook: '', instagram: '', qr: ''
                };
                applyState(empty);
                saveState(empty);
            };

            // Initialize
            const s = loadState();
            applyState(s);
            bindChanges();
            console.log('Business Card V2 Editor Ready');
        })();
    </script>
</body>
</html>
